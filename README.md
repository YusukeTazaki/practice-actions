# GitHub Actions 入門：ジョブの制御とステータス

このドキュメントでは、GitHub Actionsの基本的な動作原理と、ジョブのステータス（成功、失敗、スキップ）のコントロール方法について学びます。

## はじめに
GitHub Actionsは、YAMLファイルに定義した「ワークフロー」を自動実行する仕組みです。
ワークフローは複数の「ジョブ（Job）」から構成され、各ジョブはデフォルトで **並列（同時）** に実行されます。

本サンプルのワークフロー（`.github/workflows/learning-sample.yml`）では、外部のリソースや複雑なビルド処理を使用せず、文字の出力と簡単な計算のみを使ってGitHub Actionsの挙動を確認します。

## ワークフローの構成
本サンプルでは、以下の5つのパターンのジョブを定義しています。

### 1. Success Job（成功するジョブ）
- **概要**: 正常に処理が完了する標準的なジョブです。
- **処理内容**: `echo` コマンドによる文字表示と、シェルの機能を使った簡単な足し算（10 + 20）を行い、結果を出力します。

### 2. Failure Job（失敗するジョブ）
- **概要**: 意図的に処理を異常終了させるジョブです。
- **処理内容**: `exit 1` というコマンドを実行することで、意図的にエラー状態を作り出します。GitHub Actionsはステップがエラーを返すと、その時点でジョブを「失敗（Failed）」として中断します。そのため、それ以降のステップは実行されません。

### 3. Conditional Skip Job（条件によるスキップ）
- **概要**: 特定の条件を満たさないため、実行されずにスキップされるジョブです。
- **処理内容**: ジョブの定義に `if: false` と記述されているため、評価結果が常に「偽」となり、ジョブ自体が起動しません（ステータスは「Skipped」になります）。

### 4. Dependent Skip Job（依存によるスキップ）
- **概要**: 他のジョブの実行結果に依存しているジョブです。
- **処理内容**: `needs: job2_failure` と指定されており、2番目のジョブが終わるのを待ちます。しかし、2番目のジョブが「失敗」するため、前提条件を満たせず自動的にスキップされます。複数のジョブを順番に実行（直列実行）させたい場合は、この `needs` を使います。

### 5. Always Run Job（常に実行されるジョブ）
- **概要**: 依存しているジョブが失敗しても、強制的に実行されるジョブです。
- **処理内容**: `needs` で1番目と2番目のジョブの完了を待ちますが、`if: always()` という条件が追加されています。これにより、前段のジョブがエラー終了してもスキップされずに実行されます。実際の開発現場では、テスト失敗時のSlack通知や、後片付け（クリーンアップ）の処理によく使用されます。

## 実行と確認の手順

1. **ワークフローの実行**
   - リポジトリの [Actions] タブを開きます。
   - 左側のメニューから `GitHub Actions Learning Sample` を選択します。
   - 画面右側の `Run workflow` ボタンをクリックして、手動でワークフローを開始します（`workflow_dispatch` トリガーによる実行）。

2. **結果の確認**
   - 実行されたワークフローの「Summary（概要）」画面を開くと、各ジョブのつながりがグラフ（ノード）で表示されます。
   - 各ジョブのアイコンの色に注目してください：
     - **緑色のチェック（✔）**: `1. Success Job`, `5. Always Run Job`
     - **赤色のバツ（✖）**: `2. Failure Job`
     - **灰色の斜線（⊘）**: `3. Conditional Skip Job`, `4. Dependent Skip Job`

3. **ログの詳細確認**
   - 各ジョブの四角い枠をクリックすると、詳細な実行ログが表示されます。
   - `1. Success Job` をクリックして、計算結果（30）が正しく表示されているか確認してみましょう。
   - `2. Failure Job` をクリックして、どのステップでエラーが発生し、処理が止まったかを確認してみましょう。
